<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Playground.Interpreter.Util</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Lens</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control.Monad.Error.Class</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadError</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">throwError</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Aeson</span><span>                 </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Aeson</span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">JSON</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Lazy.Char8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSL</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Monoid</span><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Sum</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">getSum</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Typeable</span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Ledger.Types</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Blockchain</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PubKey</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PubKey</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Tx</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TxOutOf</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">txOutValue</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Value</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Value</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><a href="Playground.API.html"><span class="hs-identifier">Playground.API</span></a><span>             </span><span class="hs-special">(</span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><span class="hs-special">(</span><a href="Playground.API.html#OtherError"><span class="hs-identifier hs-var">OtherError</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Wallet.Emulator.Types</span><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-type">EmulatorEvent</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">EmulatorState</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_chainNewestFirst</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_emulatorLog</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MockWallet</span><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>                                             </span><span class="hs-identifier hs-type">Trace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Wallet</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Wallet</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ownFunds</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">processPending</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">runTraceTxPool</span><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>                                             </span><span class="hs-identifier hs-var">walletStates</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">walletsNotifyBlock</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Wallet.Generators</span><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GeneratorModel</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">GeneratorModel</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Wallet.Generators</span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Gen</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">-- | Unfortunately any uncaught errors in the interpreter kill the thread that is running it rather than returning the error. This means we need to handle all expected errors in the expression we are interpreting. This gets a little tricky because we have to decode JSON inside the interpreter (since we don't have access to it's type outside) so we need to wrap the @apply functions up in something that can throw errors.</span><span>
</span><a name="line-23"></a><span class="hs-identifier">runTrace</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-24"></a><span>     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Wallet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Trace</span><span> </span><span class="hs-identifier hs-type">MockWallet</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tx</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Blockchain</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">EmulatorEvent</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Wallet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Value</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><a name="runTrace"><a href="Playground.Interpreter.Util.html#runTrace"><span class="hs-identifier">runTrace</span></a></a><span> </span><a name="local-6989586621679261920"><a href="#local-6989586621679261920"><span class="hs-identifier">wallets</span></a></a><span> </span><a name="local-6989586621679261921"><a href="#local-6989586621679261921"><span class="hs-identifier">actions</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679261922"><a href="#local-6989586621679261922"><span class="hs-identifier">walletToBalance</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Wallet</span><span> </span><a name="local-6989586621679261926"><a href="#local-6989586621679261926"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679261927"><a href="#local-6989586621679261927"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">PubKey</span><span> </span><a href="#local-6989586621679261926"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Value</span><span> </span><a href="#local-6989586621679261927"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>      </span><a name="local-6989586621679261923"><a href="#local-6989586621679261923"><span class="hs-identifier">initialBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679261922"><span class="hs-identifier hs-var">walletToBalance</span></a><span> </span><a href="#local-6989586621679261920"><span class="hs-identifier hs-var">wallets</span></a><span>
</span><a name="line-30"></a><span>      </span><a name="local-6989586621679261924"><a href="#local-6989586621679261924"><span class="hs-identifier">pubKeys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Wallet</span><span> </span><a name="local-6989586621679261928"><a href="#local-6989586621679261928"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">PubKey</span><span> </span><a href="#local-6989586621679261928"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679261920"><span class="hs-identifier hs-var">wallets</span></a><span>
</span><a name="line-31"></a><span>      </span><a name="local-6989586621679261925"><a href="#local-6989586621679261925"><span class="hs-identifier">eActions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sequence</span><span> </span><a href="#local-6989586621679261921"><span class="hs-identifier hs-var">actions</span></a><span>
</span><a name="line-32"></a><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679261925"><span class="hs-identifier hs-var">eActions</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-33"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679262289"><a href="#local-6989586621679262289"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679262289"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-34"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679262290"><a href="#local-6989586621679262290"><span class="hs-identifier">actions'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-35"></a><span>          </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679262291"><a href="#local-6989586621679262291"><span class="hs-identifier">notifyAll</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-36"></a><span>                </span><span class="hs-identifier hs-var">processPending</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span>
</span><a name="line-37"></a><span>                </span><span class="hs-identifier hs-var">walletsNotifyBlock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Wallet</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679261920"><span class="hs-identifier hs-var">wallets</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>              </span><a name="local-6989586621679262292"><a href="#local-6989586621679262292"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679262291"><span class="hs-identifier hs-var">notifyAll</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">sequence</span><span> </span><a href="#local-6989586621679262290"><span class="hs-identifier hs-var">actions'</span></a><span>
</span><a name="line-39"></a><span>              </span><span class="hs-special">(</span><a name="local-6989586621679262293"><a href="#local-6989586621679262293"><span class="hs-identifier">initialTx</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-40"></a><span>                </span><span class="hs-identifier hs-var">Gen.genInitialTransaction</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-41"></a><span>                </span><span class="hs-identifier hs-var">GeneratorModel</span><span> </span><a href="#local-6989586621679261923"><span class="hs-identifier hs-var">initialBalance</span></a><span> </span><a href="#local-6989586621679261924"><span class="hs-identifier hs-var">pubKeys</span></a><span>
</span><a name="line-42"></a><span>              </span><span class="hs-special">(</span><a name="local-6989586621679262294"><a href="#local-6989586621679262294"><span class="hs-identifier">eRes</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679262295"><a href="#local-6989586621679262295"><span class="hs-identifier">newState</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runTraceTxPool</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679262293"><span class="hs-identifier hs-var">initialTx</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679262292"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-43"></a><span>              </span><a name="local-6989586621679262296"><a href="#local-6989586621679262296"><span class="hs-identifier">blockchain</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_chainNewestFirst</span><span> </span><a href="#local-6989586621679262295"><span class="hs-identifier hs-var">newState</span></a><span>
</span><a name="line-44"></a><span>              </span><a name="local-6989586621679262297"><a href="#local-6989586621679262297"><span class="hs-identifier">emulatorLog</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_emulatorLog</span><span> </span><a href="#local-6989586621679262295"><span class="hs-identifier hs-var">newState</span></a><span>
</span><a name="line-45"></a><span>              </span><a name="local-6989586621679262298"><a href="#local-6989586621679262298"><span class="hs-identifier">fundsDistribution</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>                </span><span class="hs-identifier hs-var">Map.map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getSum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">foldMap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Sum</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">txOutValue</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">ownFunds</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-47"></a><span>                </span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">walletStates</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-48"></a><span>                </span><a href="#local-6989586621679262295"><span class="hs-identifier hs-var">newState</span></a><span>
</span><a name="line-49"></a><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679262294"><span class="hs-identifier hs-var">eRes</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-50"></a><span>                </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-51"></a><span>                  </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679262296"><span class="hs-identifier hs-var">blockchain</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679262297"><span class="hs-identifier hs-var">emulatorLog</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Map.toList</span><span> </span><a href="#local-6989586621679262298"><span class="hs-identifier hs-var">fundsDistribution</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>                </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679263295"><a href="#local-6989586621679263295"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Playground.API.html#OtherError"><span class="hs-identifier hs-var">OtherError</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263295"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- | This will throw an exception if it cannot decode the json however it should</span><span>
</span><a name="line-55"></a><span class="hs-comment">--   never do this as long as it is only called in places where we have already</span><span>
</span><a name="line-56"></a><span class="hs-comment">--   decoded and encoded the value since it came from an HTTP API call</span><span>
</span><a name="line-57"></a><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">decode'</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&quot;HLint: ignore&quot;</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">String</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-identifier">decode'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261919"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261919"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261919"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-60"></a><a name="decode%27"><a href="Playground.Interpreter.Util.html#decode%27"><span class="hs-identifier">decode'</span></a></a><span> </span><a name="local-6989586621679263296"><a href="#local-6989586621679263296"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679263297"><a href="#local-6989586621679263297"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON.eitherDecode</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">BSL.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263296"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-62"></a><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679263297"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-63"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679263298"><a href="#local-6989586621679263298"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679263298"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-64"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679263299"><a href="#local-6989586621679263299"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-65"></a><span>          </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-66"></a><span>          </span><span class="hs-string">&quot;couldn't decode &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-67"></a><span>          </span><a href="#local-6989586621679263296"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; :: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.typeOf</span><span> </span><a href="#local-6989586621679263297"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679263299"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-identifier">decode</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-70"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261917"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261917"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261918"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261918"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261917"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-71"></a><a name="decode"><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier">decode</span></a></a><span> </span><a name="local-6989586621679263314"><a href="#local-6989586621679263314"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679263315"><a href="#local-6989586621679263315"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">JSON.eitherDecode</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">BSL.pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263314"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-73"></a><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679263315"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-74"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679263316"><a href="#local-6989586621679263316"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679263316"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-75"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679263317"><a href="#local-6989586621679263317"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-76"></a><span>          </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Playground.API.html#OtherError"><span class="hs-identifier hs-var">OtherError</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-77"></a><span>          </span><span class="hs-string">&quot;couldn't decode &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-78"></a><span>          </span><a href="#local-6989586621679263314"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; :: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.typeOf</span><span> </span><a href="#local-6989586621679263315"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679263317"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">module</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&quot;HLint: ignore Reduce duplication&quot;</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">String</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">apply</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-83"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261915"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679261916"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261915"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261916"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-86"></a><a name="apply"><a href="Playground.Interpreter.Util.html#apply"><span class="hs-identifier">apply</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">apply1</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-89"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261912"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261912"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261913"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261912"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261914"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261913"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261914"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-93"></a><a name="apply1"><a href="Playground.Interpreter.Util.html#apply1"><span class="hs-identifier">apply1</span></a></a><span> </span><a name="local-6989586621679263318"><a href="#local-6989586621679263318"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263319"><a href="#local-6989586621679263319"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679263318"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263319"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">apply2</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-96"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261908"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-97"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261908"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-98"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261909"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-99"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261909"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-100"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261910"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-101"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261908"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261909"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261911"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261910"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261911"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-106"></a><a name="apply2"><a href="Playground.Interpreter.Util.html#apply2"><span class="hs-identifier">apply2</span></a></a><span> </span><a name="local-6989586621679263320"><a href="#local-6989586621679263320"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263321"><a href="#local-6989586621679263321"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679263322"><a href="#local-6989586621679263322"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-107"></a><span>  </span><a name="local-6989586621679263323"><a href="#local-6989586621679263323"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263321"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-108"></a><span>  </span><a name="local-6989586621679263324"><a href="#local-6989586621679263324"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263322"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-109"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263320"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621679263323"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679263324"><span class="hs-identifier hs-var">b'</span></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">apply3</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-112"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261903"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-113"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261903"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-114"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261903"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-115"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261904"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-116"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261904"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-117"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261905"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-118"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261905"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-119"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261906"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-120"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261903"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261904"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261905"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261907"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-123"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261906"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261907"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-126"></a><a name="apply3"><a href="Playground.Interpreter.Util.html#apply3"><span class="hs-identifier">apply3</span></a></a><span> </span><a name="local-6989586621679263325"><a href="#local-6989586621679263325"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263326"><a href="#local-6989586621679263326"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679263327"><a href="#local-6989586621679263327"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679263328"><a href="#local-6989586621679263328"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-127"></a><span>  </span><a name="local-6989586621679263329"><a href="#local-6989586621679263329"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263326"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-128"></a><span>  </span><a name="local-6989586621679263330"><a href="#local-6989586621679263330"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263327"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-129"></a><span>  </span><a name="local-6989586621679263331"><a href="#local-6989586621679263331"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263328"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-130"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263325"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621679263329"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679263330"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679263331"><span class="hs-identifier hs-var">c'</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-identifier">apply4</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-133"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261897"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-134"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261897"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-135"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261898"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-136"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261898"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-137"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261899"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-138"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261899"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-139"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261900"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-140"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261900"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-141"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261901"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-142"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261897"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261898"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261899"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261900"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261902"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261901"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261902"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-149"></a><a name="apply4"><a href="Playground.Interpreter.Util.html#apply4"><span class="hs-identifier">apply4</span></a></a><span> </span><a name="local-6989586621679263332"><a href="#local-6989586621679263332"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263333"><a href="#local-6989586621679263333"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679263334"><a href="#local-6989586621679263334"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679263335"><a href="#local-6989586621679263335"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679263336"><a href="#local-6989586621679263336"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-150"></a><span>  </span><a name="local-6989586621679263337"><a href="#local-6989586621679263337"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263333"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-151"></a><span>  </span><a name="local-6989586621679263338"><a href="#local-6989586621679263338"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263334"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-152"></a><span>  </span><a name="local-6989586621679263339"><a href="#local-6989586621679263339"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263335"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-153"></a><span>  </span><a name="local-6989586621679263340"><a href="#local-6989586621679263340"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263336"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-154"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263332"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621679263337"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679263338"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679263339"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679263340"><span class="hs-identifier hs-var">d'</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-identifier">apply5</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-157"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261890"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-158"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261890"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-159"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261891"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-160"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261891"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-161"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261892"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-162"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261892"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-163"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261893"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-164"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261893"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-165"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261894"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-166"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261894"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-167"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261895"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-168"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261890"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261891"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261892"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261893"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261894"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261896"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261895"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261896"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-176"></a><a name="apply5"><a href="Playground.Interpreter.Util.html#apply5"><span class="hs-identifier">apply5</span></a></a><span> </span><a name="local-6989586621679263341"><a href="#local-6989586621679263341"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263342"><a href="#local-6989586621679263342"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679263343"><a href="#local-6989586621679263343"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679263344"><a href="#local-6989586621679263344"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679263345"><a href="#local-6989586621679263345"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679263346"><a href="#local-6989586621679263346"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-177"></a><span>  </span><a name="local-6989586621679263347"><a href="#local-6989586621679263347"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263342"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-178"></a><span>  </span><a name="local-6989586621679263348"><a href="#local-6989586621679263348"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263343"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-179"></a><span>  </span><a name="local-6989586621679263349"><a href="#local-6989586621679263349"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263344"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-180"></a><span>  </span><a name="local-6989586621679263350"><a href="#local-6989586621679263350"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263345"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-181"></a><span>  </span><a name="local-6989586621679263351"><a href="#local-6989586621679263351"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263346"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-182"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263341"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621679263347"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679263348"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679263349"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679263350"><span class="hs-identifier hs-var">d'</span></a><span> </span><a href="#local-6989586621679263351"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-identifier">apply6</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-185"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261882"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-186"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261882"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-187"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261883"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-188"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261883"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-189"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261884"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-190"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261884"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-191"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261885"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-192"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261885"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-193"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261886"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-194"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261886"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-195"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261887"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-196"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261887"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-197"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261888"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-198"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261883"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261884"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261885"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261886"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261887"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261889"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-201"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-204"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-206"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261888"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261889"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-207"></a><a name="apply6"><a href="Playground.Interpreter.Util.html#apply6"><span class="hs-identifier">apply6</span></a></a><span> </span><a name="local-6989586621679263352"><a href="#local-6989586621679263352"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263353"><a href="#local-6989586621679263353"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679263354"><a href="#local-6989586621679263354"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679263355"><a href="#local-6989586621679263355"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679263356"><a href="#local-6989586621679263356"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679263357"><a href="#local-6989586621679263357"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679263358"><a href="#local-6989586621679263358"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-208"></a><span>  </span><a name="local-6989586621679263359"><a href="#local-6989586621679263359"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263353"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-209"></a><span>  </span><a name="local-6989586621679263360"><a href="#local-6989586621679263360"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263354"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-210"></a><span>  </span><a name="local-6989586621679263361"><a href="#local-6989586621679263361"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263355"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-211"></a><span>  </span><a name="local-6989586621679263362"><a href="#local-6989586621679263362"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263356"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-212"></a><span>  </span><a name="local-6989586621679263363"><a href="#local-6989586621679263363"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263357"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-213"></a><span>  </span><a name="local-6989586621679263364"><a href="#local-6989586621679263364"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263358"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-214"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263352"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621679263359"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679263360"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679263361"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679263362"><span class="hs-identifier hs-var">d'</span></a><span> </span><a href="#local-6989586621679263363"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679263364"><span class="hs-identifier hs-var">f'</span></a><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-identifier">apply7</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-217"></a><span>     </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261471"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-218"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261471"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-219"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261472"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-220"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261472"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-221"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261473"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-222"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261473"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-223"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261474"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-224"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261474"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-225"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261475"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-226"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261475"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-227"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261476"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-228"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261476"><span class="hs-identifier hs-type">f</span></a><span>
</span><a name="line-229"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">T.Typeable</span><span> </span><a href="#local-6989586621679261477"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-230"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span> </span><a href="#local-6989586621679261477"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-231"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><a href="Playground.API.html#PlaygroundError"><span class="hs-identifier hs-type">PlaygroundError</span></a><span> </span><a href="#local-6989586621679261478"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-232"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679261471"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261472"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261473"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261474"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261475"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261476"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261477"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261479"><span class="hs-identifier hs-type">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-235"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679261478"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679261479"><span class="hs-identifier hs-type">h</span></a><span>
</span><a name="line-242"></a><a name="apply7"><a href="Playground.Interpreter.Util.html#apply7"><span class="hs-identifier">apply7</span></a></a><span> </span><a name="local-6989586621679263365"><a href="#local-6989586621679263365"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679263366"><a href="#local-6989586621679263366"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679263367"><a href="#local-6989586621679263367"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679263368"><a href="#local-6989586621679263368"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679263369"><a href="#local-6989586621679263369"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679263370"><a href="#local-6989586621679263370"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679263371"><a href="#local-6989586621679263371"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679263372"><a href="#local-6989586621679263372"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-243"></a><span>  </span><a name="local-6989586621679263373"><a href="#local-6989586621679263373"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263366"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-244"></a><span>  </span><a name="local-6989586621679263374"><a href="#local-6989586621679263374"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263367"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-245"></a><span>  </span><a name="local-6989586621679263375"><a href="#local-6989586621679263375"><span class="hs-identifier">c'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263368"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-246"></a><span>  </span><a name="local-6989586621679263376"><a href="#local-6989586621679263376"><span class="hs-identifier">d'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263369"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-247"></a><span>  </span><a name="local-6989586621679263377"><a href="#local-6989586621679263377"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263370"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-248"></a><span>  </span><a name="local-6989586621679263378"><a href="#local-6989586621679263378"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263371"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-249"></a><span>  </span><a name="local-6989586621679263379"><a href="#local-6989586621679263379"><span class="hs-identifier">g'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Playground.Interpreter.Util.html#decode"><span class="hs-identifier hs-var">decode</span></a><span> </span><a href="#local-6989586621679263372"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-250"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679263365"><span class="hs-identifier hs-var">fun</span></a><span> </span><a href="#local-6989586621679263373"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679263374"><span class="hs-identifier hs-var">b'</span></a><span> </span><a href="#local-6989586621679263375"><span class="hs-identifier hs-var">c'</span></a><span> </span><a href="#local-6989586621679263376"><span class="hs-identifier hs-var">d'</span></a><span> </span><a href="#local-6989586621679263377"><span class="hs-identifier hs-var">e'</span></a><span> </span><a href="#local-6989586621679263378"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621679263379"><span class="hs-identifier hs-var">g'</span></a><span>
</span><a name="line-251"></a></pre></body></html>